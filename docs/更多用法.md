# NAT1 Traversal

## 更多用法

### WEB网站
#### Linux 3.9+ 共端口模式
对于数量庞大的WEB程序，在Linux 3.9+中实现共端口模式变得非常复杂。

多数WEB程序为了能让一个二进制文件在各种Linux发行版中运行而不用为每个发行版编译一个二进制文件，通常会采用静态链接的编译方式，

静态链接的使用导致WEB程序并不会去尝试从动态运行库中搜索函数，此时我们无法让WEB程序使用我们篡改的`bind`函数。

如果您的WEB程序采用了静态链接，您可以尝试修改源代码解除静态链接或者在`bind`之前为socket设置`SO_REUSEPORT`标志。

或者您应该采用更加通用的转发模式，当然这会对并发性能产生一些影响。

您需要将`type`设置为`web`而不是默认的`mcje`，其余设置与[MCJE共端口模式](../README.md#linux-39-共端口模式)的配置方式完全相同。

您现在可以使用`域名:端口`的方式访问您的WEB应用，但是随着映射IP地址的更新，端口号也会一起发生变化，

所以为了追踪端口的变化，您还需要根据[HTTP Redirect](https://github.com/Guation/http_redirect)项目的指引配置重定向，以固化域名访问入口。

#### Windows/MacOS/Linux 转发模式
您需要将`type`设置为`web`而不是默认的`mcje`，其余设置与[MCJE转发模式](../README.md#windowsmacoslinux-转发模式)的配置方式完全相同。

您现在可以使用`域名:端口`的方式访问您的WEB应用，但是随着映射IP地址的更新，端口号也会一起发生变化，

所以为了追踪端口的变化，您还需要根据[HTTP Redirect](https://github.com/Guation/http_redirect)项目的指引配置重定向，以固化域名访问入口。

### 通用TCP应用
#### Linux 3.9+ 共端口模式
与[WEB网站共端口模式](#linux-39-共端口模式)情况类似，hook很有可能无法生效，如果未生效您需要自行修改目标应用源代码以支持`SO_REUSEPORT`标志。

或者您应该采用更加通用的转发模式。

您需要将`type`设置为`tcp`而不是默认的`mcje`，其余设置与[MCJE共端口模式](../README.md#linux-39-共端口模式)的配置方式完全相同。

#### Windows/MacOS/Linux 转发模式
您需要将`type`设置为`tcp`而不是默认的`mcje`，其余设置与[MCJE转发模式](../README.md#windowsmacoslinux-转发模式)的配置方式完全相同。

### RDP远程桌面
#### Windows/MacOS/Linux 转发模式
RDP无法采用共端口模式，将`type`设置为`tcp`，将`dns`设置为`no_dns`。

Windows RDP默认使用端口为`3389`，因此我们需要配置`remote`为`Windows主机IP:3389`。

### 通用UDP应用
#### Windows/MacOS/Linux 转发模式
由于UDP无连接特性，通用UDP应用没有有效的通用方案确认映射隧道是否可用，因此无法采用共端口模式，将`type`设置为`udp`，将`dns`设置为`no_dns`。
